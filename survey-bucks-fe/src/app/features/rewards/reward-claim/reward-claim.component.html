<!-- src/app/features/rewards/reward-claim/reward-claim.component.html -->
<div class="reward-claim-container">
  <div class="back-link">
    <a routerLink="/client/rewards" mat-button>
      <mat-icon>arrow_back</mat-icon>
      Back to Rewards
    </a>
  </div>

  <div *ngIf="loading" class="loading-container">
    <mat-progress-bar mode="indeterminate"></mat-progress-bar>
    <p>Loading reward details...</p>
  </div>

  <div *ngIf="!loading && userReward" class="claim-content">
    <div class="reward-header">
      <div
        class="reward-image"
        [style.background-image]="'url(' + userReward.imageUrl + ')'"
      ></div>

      <div class="reward-info">
        <h1>{{ userReward.rewardName }}</h1>
        <p class="reward-description">{{ userReward.rewardDescription }}</p>

        <div class="reward-meta">
          <div class="meta-item">
            <span class="meta-label">Reward Type</span>
            <span class="meta-value">{{ userReward.rewardType }}</span>
          </div>

          <div class="meta-item">
            <span class="meta-label">Redeemed On</span>
            <span class="meta-value">{{ userReward.earnedDate | date }}</span>
          </div>

          <div class="meta-item" *ngIf="userReward.claimedDate">
            <span class="meta-label">Claimed On</span>
            <span class="meta-value">{{ userReward.claimedDate | date }}</span>
          </div>
        </div>
      </div>
    </div>

    <div *ngIf="!claimed" class="claim-process">
      <h2>Claim Your Reward</h2>

      <mat-stepper [linear]="true" orientation="vertical">
        <mat-step label="Confirm Reward Details" state="confirm">
          <div class="step-content">
            <p>Please verify that this is the reward you want to claim:</p>

            <ul class="reward-details-list">
              <li><strong>Reward Name:</strong> {{ userReward.rewardName }}</li>
              <li><strong>Reward Type:</strong> {{ userReward.rewardType }}</li>
              <li *ngIf="userReward.rewardAmount">
                <strong>Reward Amount:</strong> {{ userReward.rewardAmount }}
              </li>
            </ul>

            <div class="step-actions">
              <button mat-button matStepperNext>Confirm & Continue</button>
            </div>
          </div>
        </mat-step>

        <mat-step label="Review Terms & Conditions" state="terms">
          <div class="step-content">
            <p>By claiming this reward, you agree to the following terms:</p>

            <ul class="terms-list">
              <li>
                This reward may be subject to additional terms and conditions
                from the provider.
              </li>
              <li>Rewards must be claimed within 30 days of redemption.</li>
              <li>Once claimed, rewards cannot be returned or exchanged.</li>
              <li>
                For physical rewards, shipping details will be collected in the
                next step.
              </li>
              <li>
                For digital rewards, codes will be provided immediately after
                claiming.
              </li>
            </ul>

            <div class="step-actions">
              <button mat-button matStepperPrevious>Back</button>
              <button mat-button matStepperNext>Accept Terms</button>
            </div>
          </div>
        </mat-step>

        <mat-step label="Complete Claim" state="complete">
          <div class="step-content">
            <p>
              You're almost done! Click the button below to complete your claim.
            </p>

            <div class="step-actions">
              <button mat-button matStepperPrevious>Back</button>
              <button
                mat-raised-button
                color="primary"
                (click)="claimReward()"
                [disabled]="claiming"
              >
                <mat-icon *ngIf="!claiming">check_circle</mat-icon>
                <mat-progress-bar
                  *ngIf="claiming"
                  mode="indeterminate"
                  class="button-progress"
                ></mat-progress-bar>
                {{ claiming ? "Processing..." : "Claim Reward Now" }}
              </button>
            </div>
          </div>
        </mat-step>
      </mat-stepper>
    </div>

    <div *ngIf="claimed" class="claim-success">
      <mat-card>
        <mat-card-content>
          <div class="success-icon">
            <mat-icon>check_circle</mat-icon>
          </div>

          <h2>Reward Successfully Claimed!</h2>
          <p>Congratulations! You have successfully claimed your reward.</p>

          <div *ngIf="userReward.redemptionCode" class="redemption-code">
            <h3>Your Redemption Code</h3>
            <div class="code-display">
              <span>{{ userReward.redemptionCode }}</span>
            </div>
            <p class="code-instructions">
              Use this code to redeem your reward at the provider's website or
              store.
            </p>
          </div>

          <div
            *ngIf="userReward.redemptionInstructions"
            class="redemption-instructions"
          >
            <h3>Redemption Instructions</h3>
            <p>{{ userReward.redemptionInstructions }}</p>
          </div>

          <div class="claim-actions">
            <button
              mat-raised-button
              color="primary"
              routerLink="/client/rewards"
            >
              Back to Rewards
            </button>
          </div>
        </mat-card-content>
      </mat-card>
    </div>
  </div>
</div>
